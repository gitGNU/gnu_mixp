2011-08-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat int] Remove redundant ‘SPECIFIEDP’ checks.

	For non-pair (no -start, -end) handlers, setting the generic
	handler happens only if value satisfies init-time ‘PROCP’ check,
	so all the parse-time ‘SPECIFIEDP’ checks are redundant.

	* src/expat.c (generic_character_data)
	(generic_processing_instruction, generic_comment)
	(generic_default, generic_default_expand)
	(generic_unparsed_entity_decl, generic_notation_decl)
	(generic_not_standalone, generic_unknown_encoding): Don't
	bother checking that the handler is ‘SPECIFIEDP’; use it directly.

2011-08-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat int] Use XML_STATUS_* more.

	* src/expat.c (generic_not_standalone): Use ‘XML_STATUS_OK’.
	(generic_external_entity_ref): Likewise, and ‘XML_STATUS_ERROR’.
	(generic_unknown_encoding): Likewise.

2011-08-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Drop proc: set-encoding

	* src/expat.c (set_encoding): Delete func.
	* test/x001: Don't import ‘set-encoding’; don't test it.

2011-08-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat int] Use ‘INT_NUM’ and ‘C_INT’ more.

	* src/expat.c: Do ‘s/SCM_MAKINUM/INT_NUM/g’, ‘s/SCM_INUM/C_INT/g’.

2011-08-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat int] Do only one ‘scm_puts’ in print funcs.

	* src/expat.c (print_parser, print_encoding):
	Construct C string locally and ‘scm_puts’ once, at end.

2011-08-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Add proc: hget

	* src/expat.c (hget): New PRIMPROC.

2011-08-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Rename lastchoice{,-expand} to default{,-expand}.

	* src/expat.c (hnames): Use "default" and "default-expand"
	instead of "lastchoice" and "lastchoice-expand".
	(enum hindices): Rename all elements w/ prefix
	"hx_"; use ‘hx_default’ and ‘hx_default_expand’.
	(udsel): Prefix ‘h’ with "hx_".
	(generic_default): Rename from ‘generic_lastchoice’.
	(generic_default_expand): Rename from ‘generic_lastchoice_expand’.
	(hset_x): Update local macros to prefix "hx_"; use ‘default’
	and ‘default_expand’ instead of ‘lastchoice’ and ‘lastchoice_expand’.

2011-08-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Make ‘hset!’ take alist as required 2nd arg.

	* src/expat.c (hset_x): Rename 2nd arg to ‘alist’; change
	req-opt-var spec to 2-0-0; update validation / setting.
	* src/utils.scm (xml->tree): Update call to ‘expat:hset!’.
	* test/x001 (hset!/p): New proc; do ‘s|E:hset!|hset!/p|g’.

2011-08-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[utils int] Rewrite ‘xml->tree’.

	* src/utils.scm: Import ‘append-map’, ‘car+cdr’
	from (srfi srfi-1); import ‘(srfi srfi-11) let-values’.
	(xml->tree): Rewrite.
	(list->tree/one, list->tree, xml->list): Delete procs.

2011-08-03  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[utils] Internalize/prune list-related procs.

	These impose a profligate implementation strategy
	that we don't want to support long-term.

	* test/x001: Don't import ‘xml->list’, ‘list->tree/one’,
	‘tree->list/one’; remove tests that touch those procs.
	* src/utils.scm (tree->list/one, tree->list): Delete procs.
	(xml->list, list->tree/one, list->tree): Don't export.

2011-07-31  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Maintain attributes order.

	* src/expat.c (generic_element_start): Reverse
	the ‘acons’-built attributes alist if non-empty.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[v int] Use succint prefixes in ‘define-module’ form.

	* test/x001: Do ‘s/expat:/E:/g’, ‘s/mixp:/U:/g’.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[v int] Don't say "error code" in tests.

	* test/x001: Rework to avoid "error code" and ‘error-code’.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Rename ‘get-error-code’ to ‘error-symbol’.

	* src/expat.c (error_int_to_symbol): Delete func.
	(error_symbol): Rename from ‘get_error_code’; rename Scheme
	proc to ‘error-symbol’; incorporate ‘error_int_to_symbol’.
	* src/utils.scm: Do ‘s/get-error-code/error-symbol/g’.
	* test/x001: Likewise.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Drop proc: symbol<-error-code

	* src/expat.c (symbol_from_error_code): Delete func.
	* test/x001: Don't import ‘(mixp expat) symbol<-error-code’.
	("Test the error string reporting"): Drop ‘symbol<-error-code’ check.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Add some libexpat 2.0 error codes.

	* src/expat.c (error_codes) [2 == XML_MAJOR_VERSION]: Add
	‘XML_ERROR_RESERVED_PREFIX_XML’, ‘XML_ERROR_RESERVED_PREFIX_XMLNS’,
	‘XML_ERROR_RESERVED_NAMESPACE_URI’.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat] Fix bug: Make ‘error-string’ handle unrecognized codes.

	Strangely, ‘XML_ErrorString (XML_ERROR_NONE)’ => ‘NULL’.
	That is the unique value in ‘enum XML_Error’ manifesting this.

	* src/expat.c (error_string): Return ‘#f’ if ‘code’ is unrecognized.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[doc] Combine indices.

	* doc/mixp.texi: Combine function index into concept index.
	(Top): Update menu.
	(Index): New @node, from merging ‘Concept index’ and ‘Function index’.

2011-07-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[expat int] Add abstraction: UD_SIZE

	* src/expat.c (UD_SIZE): New #define.
	(free_parser, make_parser): Use ‘UD_SIZE’.

2011-07-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[doc int] Re-encode .texi in UTF-8.

	* mixp.texi: Specify document encoding as UTF-8;
	on save, re-encode in UTF-8 (was ISO-8859-1 aka LATIN-1).

2011-07-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[doc int] Remove "manual threading"; add missing ‘@top’ directive.

	* mixp.texi: For each ‘@node’ line, remove
	everything from the first comma to end of line.
	(Top): Add ‘@top’ directive.

2011-07-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[doc] Fix some improper ‘@xref’ usage.

	These were flagged by makeinfo (GNU texinfo) 4.13.

	* doc/mixp.texi (How to...): Use ‘@pxref’.
	(Expat handlers): Reword to put ‘@xref’ at end of sentence.
	(Error handling): Use ‘@pxref’.

2011-07-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[v int] Prune obsoleted infrastructure.

	* configure.ac (AC_CONFIG_FILES): Remove check-mixp.
	* check-mixp.in: Delete file.
	* guile-expat.c: Delete file.

2011-07-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[v] Import test/infrastructure from ttn-do 381 for "make check".

	* test/Makefile.am: New file.
	* test/runtest.in: New file.
	* test/x001: New file.
	* Makefile.am (SUBDIRS): Add test.
	(EXTRA_DIST): Remove test.
	(TESTS): Delete var.
	* configure.ac (AC_CONFIG_FILES): Add test/Makefile, test/runtest.
	* src/Makefile.am (stamp-all): New target.
	(CLEANFILES): Add stamp-all.

2011-07-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[build] Build from source in src/, not in top-level dir.

	* src/Makefile.am: New file.
	* build-aux/snuggle.m4: New file.
	* build-aux/sofix: New file.
	* build-aux/uninstall-sofixed: New file.
	* autogen.sh: Don't check/ensure build-aux/ existence;
	import Guile-BAUX modules for configure/build.
	* configure.ac (AC_CONFIG_HEADERS): Move config.h to src/.
	(DETERMINE_GUILE_LIBSITE_DIR): New macro call.
	(guile_cv_mkmodcat): New GUILE_TOOLS_EXISTSP for make-module-catalog.
	(mmc): New AC_SUBST.
	(TRIPPY): New AM_CONDITIONAL.
	(AC_CONFIG_FILES): Add src/Makefile.
	* Makefile.am (SUBDIRS): Add src.
	(lib_LTLIBRARIES, libmixp_la_SOURCES, libmixp_la_CFLAGS)
	(libmixp_la_LDFLAGS, libmixp_la_LIBADD, bin_PROGRAMS)
	(guile_expat_SOURCES, guile_expat_CFLAGS, guile_expat_LDFLAGS)
	(guile_expat_LDADD, noinst_HEADERS, BUILT_SOURCES)
	(subpkgdatadir, subpkgdata_DATA): Delete vars.
	(gexpat.x): Delete prereq decl.
	(SUFFIXES, SNARF): Delete vars.
	(.c.x): Delete old-style suffix rule.
	(MKDEP, CLEANFILES): Delete vars.
	(EXTRA_DIST): Add build-aux/sofix,
	build-aux/uninstall-sofixed, build-aux/guile-baux.

2011-07-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Rename modules in new source; incorporate ttn-do dependecies.

	* src/utils.scm: Rename from mixp.scm; rename to (mixp utils).
	(fs, accumulator): New procs, from (ttn-do zzz personally).
	(ubs?): New object property, from (ttn-do zzz emacsdream).
	(recognizable-as-ubs): New proc, from same.
	(make-unsigned-byte-stream): Likewise; don't use ‘define*’;
	take optional arg ‘check’ instead of keyword arg.
	(utf8-reader, valid-ucs?, valid-ucs2?): Likewise.
	* src/expat.c (init_mixp_expat_module):
	Rename from ‘init_ttn_do_zz_xml_expat_module’.
	(MOD_INIT_LINK_THUNK): Update ref; rename to (mixp expat).

2011-07-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[int] Import variant source from ttn-do 381.

	See <http://www.gnuvola.org/software/ttn-do/> for details.

	* src/expat.c: New file.
	* src/gi.h: New file.
	* src/mixp.scm: New file.

2011-07-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[doc int] Add infrastructure for building documentation.

	* doc/Makefile.am: New file.
	* Makefile.am (SUBDIRS): New var.
	(EXTRA_DIST): Remove doc.
	* configure.ac (AC_CONFIG_FILES): Add doc/Makefile.

2011-07-28  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[v] Consoliate test files in test/.

	* samples/REC-xml-19980210.xml: Move from here...
	* test/REC-xml-19980210.xml: ...to here.
	* test/test-mixp.scm (test-mixp->): Update input file location.
	* Makefile.am (EXTRA_DIST): Remove samples.
	* samples/: Delete directory.

2011-07-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	[boot] Modernize configure.ac et al a bit.

	* autogen.sh: Rewrite.
	* configure.ac (AC_PREREQ): Specify ‘2.67’.
	(AC_INIT): Use 3-arg form.
	(AC_CONFIG_AUX_DIR): New macro call.
	(AC_CONFIG_HEADERS): Rename from ‘AM_CONFIG_HEADER’.
	(AC_CONFIG_MACRO_DIR): New macro call.
	(AM_INIT_AUTOMAKE): Use 1-arg form.
	(AM_MAINTAINER_MODE): New macro call.
	(AC_ISC_POSIX, AC_PROG_LIBTOOL): Delete macro calls.
	(strerror): New AC_SEARCH_LIBS.
	(LT_PREREQ, LT_INIT): New macro calls.
	(AM_WITH_EXPAT): Replace macro call with expansion;
	use ‘AS_HELP_STRING’, ‘AS_IF’, etc.
	(AC_CONFIG_FILES): Add Makefile.
	(AC_OUTPUT): Use no-arg form.
	* Makefile.am (ACLOCAL_AMFLAGS): Update.
	(INCLUDES): Delete var.
	(EXTRA_DIST): Remove aclocal, INSTALL.old, INSTALL.
	* INSTALL, INSTALL.old: Delete files.
	* aclocal/guile.m4: Delete file.
	* aclocal/expat.m4: Delete file.
	* aclocal/: Delete directory.

2004-06-28  Dale P. Smith  <dsmith@sourceforge.net>

	[v] Adapt code to Guile 1.6 syntax.

	* test/test-mixp.scm: Changed all non-syntax unquoted () to '().
	Changed all calls to format to include the port (or #t/#f) as a
	first argument.

2003-01-15  Dmitry Morozhnikov  <dmiceman@mail.ru>

	Work around Guile 1.6.1 bug: Export (xml mixp) macros, too.

	Reported by Christian Neukirchen.

2003-01-09  Dmitry Morozhnikov  <dmiceman@mail.ru>

	Adapt to work with Guile 1.6.

	Reported by Christian Neukirchen.

2002-09-12  Dmitry Morozhnikov  <dmiceman@mail.ru>

	Also distribute INSTALL.

2002-09-12  Dmitry Morozhnikov  <dmiceman@mail.ru>

	Mention ‘--with-expat’ option to configure script in README.

2001-08-12  Seth Alves, Eric Hanchrow

	* Seth and Eric reported a compilation problem: CFLAGS included
	the standard directories before the expat directory, which could
	lead to compilation errors if another version of expat is
	installed somewhere else.

	* Other patches by Seth Alves seem to be necessary with the CVS
	version of Guile. See the INSTALL file.

2001-07-14  Thierry Bezecourt  <thbz@thbz.org>

        * No functionality modification. I only change my email address.

2000-08-30  Thierry Bezecourt  <thbz@thbz.cx>

	* mixp.texi: more documentation about handlers.

	* gexpat.c, generic_handlers.h: debugging of the external entity
	parsing.

2000-08-26  Thierry Bezecourt  <thbz@thbz.cx>

	* gexpat.c, generic_handlers.h: support for external entity
	parsing (see doc.)

	* xml/mixp.scm: added mixp:call-with-input-string and
	mixp:call-with-input-file

2000-08-01  Thierry Bezecourt  <thbz@thbz.cx>

	* doc/mixp.texi: bug fix in the documentation (Thanks to Olivier
	Buechel.)

2000-06-16  Thierry Bezecourt  <thbz@thbz.cx>

	* compilation: replaced deprecated function calls (Thanks to
	Olivier Buechel.)

2000-02-07  Thierry Bezecourt  <thbz@worldnet.fr>

	* xml/mixp.scm (mixp:tree->list, mixp:list->tree): added these
	procs.

	* gexpat.c (xml_get_error_code): fixed the return code of this
	function (which was simply wrong).

2000-01-27  Thierry Bezecourt  <thbz@worldnet.fr>

	* xml/mixp.scm (xml): added two procedures: mixp:xml->list to build a
	list of XML nodes from a port, mixp:xml->tree to build a tree
	of XML nodes from a port (the implementation is tail-recursive to
	avoid stack overflows).

	* gexpat.c, mixp.texi: removed expat:parser-free from the Scheme
	interface (the garbage collector will take care of that).

1999-12-22  Thierry Bezecourt  <thbz@worldnet.fr>

	* mixp.scm: added mixp:utf8->latin1 to convert UTF-8 strings
	(returned by the parser) to Latin-1 strings. Will fail if the
	original string is not a valid UTF-8 string, or if it contains
	non-Latin-1 characters.

	* mixp.scm: added other conversion functions: mixp:utf8->ucs2,
	mixp:utf8->ucs4


Copyright (C) 2011 Thien-Thi Nguyen

Copying and distribution of this file, with or without modification,
are permitted provided the copyright notice and this notice are preserved.
